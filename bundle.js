/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function n(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var r=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._events=new Map}var n,r;return n=t,r=[{key:"on",value:function(t,e){var n;this._events.has(t)||this._events.set(t,new Set),null===(n=this._events.get(t))||void 0===n||n.add(e)}},{key:"off",value:function(t,e){var n;this._events.has(t)&&(this._events.get(t).delete(e),0===(null===(n=this._events.get(t))||void 0===n?void 0:n.size)&&this._events.delete(t))}},{key:"emit",value:function(t,e){this._events.forEach((function(n,r){"*"===r&&n.forEach((function(n){return n({eventName:t,data:e})})),(r instanceof RegExp&&r.test(t)||r===t)&&n.forEach((function(t){return t(e)}))}))}},{key:"onAll",value:function(t){this.on("*",t)}},{key:"offAll",value:function(){this._events=new Map}},{key:"trigger",value:function(t,e){var n=this;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.emit(t,Object.assign(Object.assign({},r||{}),e||{}))}}}],r&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}()),o="https://larek-api.nomoreparties.co/content/weblarek";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function u(){var t=p(),e=t.m(u),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,a(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(u=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new v(t,e)},AsyncIterator:s,async:function(t,e,n,o,u){return(r(e)?l:f)(i(t),e,n,o,u)},keys:c,values:a}})()}function a(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(i(t)+" is not iterable")}function c(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function f(t,e,n,r,o){var i=l(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function l(t,e,n,r,o){return new s(p().w(t,e,n,r),o||Promise)}function s(t,e){function n(r,o,i,u){try{var a=t[r](o),c=a.value;return c instanceof v?e.resolve(c.v).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(c).then((function(t){a.value=t,i(a)}),(function(t){return n("throw",t,i,u)}))}catch(t){u(t)}}var r;this.next||(y(s.prototype),y(s.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),y(this,"_invoke",(function(t,o,i){function u(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(u,u):u()}),!0)}function p(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof a?r:a,f=Object.create(c.prototype);return y(f,"_invoke",function(n,r,o){var i,a,c,f=0,l=o||[],s=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function y(n,r){for(a=n,c=r,e=0;!s&&f&&!o&&e<l.length;e++){var o,i=l[e],y=p.p,v=i[2];n>3?(o=v===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=n<2&&y<i[1])?(a=0,p.v=r,p.n=i[1]):y<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,p.n=v,a=0))}if(o||n>1)return u;throw s=!0,r}return function(o,l,v){if(f>1)throw TypeError("Generator is already running");for(s&&1===l&&y(l,v),a=l,c=v;(e=a<2?t:c)||!s;){i||(a?a<3?(a>1&&(p.n=-1),y(a,c)):p.n=c:p.v=c);try{if(f=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(s=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{f=1}}return{value:e,done:s}}}(n,o,i),!0),f}var u={};function a(){}function c(){}function f(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(y(e={},r,(function(){return this})),e),s=f.prototype=a.prototype=Object.create(l);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,y(t,o,"GeneratorFunction")),t.prototype=Object.create(s),t}return c.prototype=f,y(s,"constructor",f),y(f,"constructor",c),c.displayName="GeneratorFunction",y(f,o,"GeneratorFunction"),y(s),y(s,o,"Generator"),y(s,r,(function(){return this})),y(s,"toString",(function(){return"[object Generator]"})),(p=function(){return{w:i,m:v}})()}function y(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}y=function(t,e,n,r){function i(e,n){y(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},y(t,e,n,r)}function v(t,e){this.v=t,this.k=e}function m(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var b=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cdnUrl=e,this.apiUrl=n,this.defaultOptions=r}var e,n,r,o;return e=t,n=[{key:"getCdnUrl",value:function(){return this.cdnUrl}},{key:"request",value:(r=u().mark((function t(e){var n,r,o,i=arguments;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},t.next=3,fetch(this.apiUrl+e,Object.assign(Object.assign(Object.assign({},this.defaultOptions),n),{headers:Object.assign(Object.assign({"Content-Type":"application/json"},this.defaultOptions.headers),n.headers)}));case 3:if((r=t.sent).ok){t.next=9;break}return t.next=7,r.json().catch((function(){return{}}));case 7:throw o=t.sent,new Error(o.error||"Ошибка: ".concat(r.status));case 9:return t.abrupt("return",r.json());case 10:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function u(t){m(i,n,o,u,a,"next",t)}function a(t){m(i,n,o,u,a,"throw",t)}u(void 0)}))},function(t){return o.apply(this,arguments)})},{key:"get",value:function(t){return this.request(t,{method:"GET"})}},{key:"post",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return this.request(t,{method:n,body:JSON.stringify(e)})}}],n&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function g(){var t=P(),e=t.m(g),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,S(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(g=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new E(t,e)},AsyncIterator:_,async:function(t,e,n,o,u){return(r(e)?k:j)(i(t),e,n,o,u)},keys:O,values:S}})()}function S(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(w(t)+" is not iterable")}function O(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function j(t,e,n,r,o){var i=k(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function k(t,e,n,r,o){return new _(P().w(t,e,n,r),o||Promise)}function _(t,e){function n(r,o,i,u){try{var a=t[r](o),c=a.value;return c instanceof E?e.resolve(c.v).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(c).then((function(t){a.value=t,i(a)}),(function(t){return n("throw",t,i,u)}))}catch(t){u(t)}}var r;this.next||(x(_.prototype),x(_.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),x(this,"_invoke",(function(t,o,i){function u(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(u,u):u()}),!0)}function P(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof a?r:a,f=Object.create(c.prototype);return x(f,"_invoke",function(n,r,o){var i,a,c,f=0,l=o||[],s=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function y(n,r){for(a=n,c=r,e=0;!s&&f&&!o&&e<l.length;e++){var o,i=l[e],y=p.p,v=i[2];n>3?(o=v===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=n<2&&y<i[1])?(a=0,p.v=r,p.n=i[1]):y<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,p.n=v,a=0))}if(o||n>1)return u;throw s=!0,r}return function(o,l,v){if(f>1)throw TypeError("Generator is already running");for(s&&1===l&&y(l,v),a=l,c=v;(e=a<2?t:c)||!s;){i||(a?a<3?(a>1&&(p.n=-1),y(a,c)):p.n=c:p.v=c);try{if(f=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(s=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{f=1}}return{value:e,done:s}}}(n,o,i),!0),f}var u={};function a(){}function c(){}function f(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(x(e={},r,(function(){return this})),e),s=f.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,x(t,o,"GeneratorFunction")),t.prototype=Object.create(s),t}return c.prototype=f,x(s,"constructor",f),x(f,"constructor",c),c.displayName="GeneratorFunction",x(f,o,"GeneratorFunction"),x(s),x(s,o,"Generator"),x(s,r,(function(){return this})),x(s,"toString",(function(){return"[object Generator]"})),(P=function(){return{w:i,m:p}})()}function x(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}x=function(t,e,n,r){function i(e,n){x(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},x(t,e,n,r)}function E(t,e){this.v=t,this.k=e}function C(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function T(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){C(i,r,o,u,a,"next",t)}function a(t){C(i,r,o,u,a,"throw",t)}u(void 0)}))}}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,G(r.key),r)}}function G(t){var e=function(t,e){if("object"!=w(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:e+""}var F=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.api=e}var e,n,r,o,i;return e=t,n=[{key:"getCdnUrl",value:function(){return this.api.getCdnUrl()}},{key:"getProducts",value:(i=T(g().mark((function t(){var e;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.get("/product");case 2:return e=t.sent,t.abrupt("return",e.items);case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getProduct",value:(o=T(g().mark((function t(e){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.api.get("/product/".concat(e)));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"sendOrder",value:(r=T(g().mark((function t(e){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.api.post("/order",e,"POST"));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],n&&N(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L(r.key),r)}}function L(t){var e=function(t,e){if("object"!=I(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==I(e)?e:e+""}var A=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.products=[],this.updateListeners=[]}var e,n;return e=t,(n=[{key:"setProducts",value:function(t){this.products=t,this.emitUpdate()}},{key:"getProducts",value:function(){return this.products}},{key:"getProduct",value:function(t){return this.products.find((function(e){return e.id===t}))}},{key:"onUpdate",value:function(t){this.updateListeners.push(t)}},{key:"emitUpdate",value:function(){this.updateListeners.forEach((function(t){return t()}))}}])&&q(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function R(t){var e=function(t,e){if("object"!=U(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}var H=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.items=[],this.updateListeners=[]}var e,n;return e=t,(n=[{key:"getItems",value:function(){return function(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return B(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.items)}},{key:"addItem",value:function(t){this.items.find((function(e){return e.id===t.id}))||(this.items.push(t),this.emitUpdate())}},{key:"removeItem",value:function(t){this.items=this.items.filter((function(e){return e.id!==t})),this.emitUpdate()}},{key:"getTotal",value:function(){return this.items.reduce((function(t,e){var n;return t+(null!==(n=e.price)&&void 0!==n?n:0)}),0)}},{key:"getCount",value:function(){return this.items.length}},{key:"clear",value:function(){this.items=[],this.emitUpdate()}},{key:"hasProduct",value:function(t){return this.items.some((function(e){return e.id===t}))}},{key:"onUpdate",value:function(t){this.updateListeners.push(t)}},{key:"emitUpdate",value:function(){this.updateListeners.forEach((function(t){return t()}))}}])&&M(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,D(r.key),r)}}function D(t){var e=function(t,e){if("object"!=V(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==V(e)?e:e+""}var W=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.payment="",this.email="",this.phone="",this.address="",this.formErrors={},this.updateCallbacks=[]}var e,n;return e=t,(n=[{key:"onUpdate",value:function(t){this.updateCallbacks.push(t)}},{key:"emitUpdate",value:function(){this.updateCallbacks.forEach((function(t){return t()}))}},{key:"setOrderAddress",value:function(t){this.address=t,this.validateOrder(),this.emitUpdate()}},{key:"setPayment",value:function(t){this.payment=t,this.validateOrder(),this.emitUpdate()}},{key:"validateOrder",value:function(){var t={};return this.address||(t.address="Необходимо указать адрес"),this.payment||(t.payment="Выберите способ оплаты"),this.formErrors=t,0===Object.keys(t).length}},{key:"setEmail",value:function(t){this.email=t,this.validateContactFields(),this.emitUpdate()}},{key:"setPhone",value:function(t){this.phone=t,this.validateContactFields(),this.emitUpdate()}},{key:"validateContactFields",value:function(){var t={};return this.email?/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(this.email)||(t.email="Некорректный адрес электронной почты"):t.email="Необходимо указать email",this.phone.startsWith("8")&&(this.phone="+7"+this.phone.slice(1)),this.phone?/^[\d\-\+\(\) ]{7,20}$/.test(this.phone)||(t.phone="Некорректный формат номера телефона"):t.phone="Необходимо указать телефон",this.formErrors=t,0===Object.keys(t).length}},{key:"getOrderLot",value:function(){return{payment:this.payment,email:this.email,phone:this.phone,address:this.address}}},{key:"clear",value:function(){this.email="",this.phone="",this.address="",this.payment="",this.formErrors={},this.emitUpdate()}}])&&Y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function z(){var t=tt(),e=t.m(z),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,J(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(z=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new nt(t,e)},AsyncIterator:Z,async:function(t,e,n,o,u){return(r(e)?X:Q)(i(t),e,n,o,u)},keys:K,values:J}})()}function J(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError($(t)+" is not iterable")}function K(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Q(t,e,n,r,o){var i=X(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function X(t,e,n,r,o){return new Z(tt().w(t,e,n,r),o||Promise)}function Z(t,e){function n(r,o,i,u){try{var a=t[r](o),c=a.value;return c instanceof nt?e.resolve(c.v).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(c).then((function(t){a.value=t,i(a)}),(function(t){return n("throw",t,i,u)}))}catch(t){u(t)}}var r;this.next||(et(Z.prototype),et(Z.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),et(this,"_invoke",(function(t,o,i){function u(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(u,u):u()}),!0)}function tt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof a?r:a,f=Object.create(c.prototype);return et(f,"_invoke",function(n,r,o){var i,a,c,f=0,l=o||[],s=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function y(n,r){for(a=n,c=r,e=0;!s&&f&&!o&&e<l.length;e++){var o,i=l[e],y=p.p,v=i[2];n>3?(o=v===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=n<2&&y<i[1])?(a=0,p.v=r,p.n=i[1]):y<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,p.n=v,a=0))}if(o||n>1)return u;throw s=!0,r}return function(o,l,v){if(f>1)throw TypeError("Generator is already running");for(s&&1===l&&y(l,v),a=l,c=v;(e=a<2?t:c)||!s;){i||(a?a<3?(a>1&&(p.n=-1),y(a,c)):p.n=c:p.v=c);try{if(f=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(s=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{f=1}}return{value:e,done:s}}}(n,o,i),!0),f}var u={};function a(){}function c(){}function f(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(et(e={},r,(function(){return this})),e),s=f.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,et(t,o,"GeneratorFunction")),t.prototype=Object.create(s),t}return c.prototype=f,et(s,"constructor",f),et(f,"constructor",c),c.displayName="GeneratorFunction",et(f,o,"GeneratorFunction"),et(s),et(s,o,"Generator"),et(s,r,(function(){return this})),et(s,"toString",(function(){return"[object Generator]"})),(tt=function(){return{w:i,m:p}})()}function et(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}et=function(t,e,n,r){function i(e,n){et(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},et(t,e,n,r)}function nt(t,e){this.v=t,this.k=e}function rt(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(){var t=st(),e=t.m(it),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ut(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(it=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new yt(t,e)},AsyncIterator:lt,async:function(t,e,n,o,u){return(r(e)?ft:ct)(i(t),e,n,o,u)},keys:at,values:ut}})()}function ut(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(ot(t)+" is not iterable")}function at(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function ct(t,e,n,r,o){var i=ft(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function ft(t,e,n,r,o){return new lt(st().w(t,e,n,r),o||Promise)}function lt(t,e){function n(r,o,i,u){try{var a=t[r](o),c=a.value;return c instanceof yt?e.resolve(c.v).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(c).then((function(t){a.value=t,i(a)}),(function(t){return n("throw",t,i,u)}))}catch(t){u(t)}}var r;this.next||(pt(lt.prototype),pt(lt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),pt(this,"_invoke",(function(t,o,i){function u(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(u,u):u()}),!0)}function st(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof a?r:a,f=Object.create(c.prototype);return pt(f,"_invoke",function(n,r,o){var i,a,c,f=0,l=o||[],s=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function y(n,r){for(a=n,c=r,e=0;!s&&f&&!o&&e<l.length;e++){var o,i=l[e],y=p.p,v=i[2];n>3?(o=v===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=n<2&&y<i[1])?(a=0,p.v=r,p.n=i[1]):y<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,p.n=v,a=0))}if(o||n>1)return u;throw s=!0,r}return function(o,l,v){if(f>1)throw TypeError("Generator is already running");for(s&&1===l&&y(l,v),a=l,c=v;(e=a<2?t:c)||!s;){i||(a?a<3?(a>1&&(p.n=-1),y(a,c)):p.n=c:p.v=c);try{if(f=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(s=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{f=1}}return{value:e,done:s}}}(n,o,i),!0),f}var u={};function a(){}function c(){}function f(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(pt(e={},r,(function(){return this})),e),s=f.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,pt(t,o,"GeneratorFunction")),t.prototype=Object.create(s),t}return c.prototype=f,pt(s,"constructor",f),pt(f,"constructor",c),c.displayName="GeneratorFunction",pt(f,o,"GeneratorFunction"),pt(s),pt(s,o,"Generator"),pt(s,r,(function(){return this})),pt(s,"toString",(function(){return"[object Generator]"})),(st=function(){return{w:i,m:p}})()}function pt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}pt=function(t,e,n,r){function i(e,n){pt(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},pt(t,e,n,r)}function yt(t,e){this.v=t,this.k=e}function vt(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dt(r.key),r)}}function dt(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ot(e)?e:e+""}var ht=function(){function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.catalog=e,this.view=n,this.api=r,this.catalog.onUpdate((function(){return o.render()}))}var e,n,r,o;return e=t,n=[{key:"fetchAndRender",value:(r=it().mark((function t(){var e;return it().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.getProducts();case 2:e=t.sent,this.catalog.setProducts(e);case 4:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function u(t){vt(i,n,o,u,a,"next",t)}function a(t){vt(i,n,o,u,a,"throw",t)}u(void 0)}))},function(){return o.apply(this,arguments)})},{key:"render",value:function(){var t=this.catalog.getProducts();this.view.render(t)}}],n&&mt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gt(r.key),r)}}function gt(t){var e=function(t,e){if("object"!=bt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bt(e)?e:e+""}var St=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cart=e}var e,n;return e=t,(n=[{key:"getItems",value:function(){return this.cart.getItems()}},{key:"getTotal",value:function(){return this.cart.getTotal()}},{key:"getCount",value:function(){return this.cart.getCount()}},{key:"handleRemoveItem",value:function(t){return this.cart.removeItem(t)}}])&&wt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kt(r.key),r)}}function kt(t){var e=function(t,e){if("object"!=Ot(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ot(e)?e:e+""}function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xt(r.key),r)}}function xt(t){var e=function(t,e){if("object"!=_t(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=_t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_t(e)?e:e+""}function Et(t,e){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Et(t,e)}function Ct(t){var e=Tt();return function(){var n,r=Nt(t);if(e){var o=Nt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==_t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Tt=function(){return!!t})()}function Nt(t){return Nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nt(t)}var Gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Et(t,e)}(o,t);var e,n,r=Ct(o);function o(t,e){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,t)).emitter=e,n.contentContainer=n.element.querySelector(".modal__content"),!n.contentContainer)throw new Error("Modal content container not found");return n.setupCloseHandlers(),n.emitter.on("modal:close",(function(){return n.close()})),n}return e=o,(n=[{key:"open",value:function(){this.show(),document.body.classList.add("page_fixed"),this.emitter.emit("modal:open")}},{key:"close",value:function(){this.hide(),document.body.classList.remove("page_fixed"),this.onCloseCallback&&this.onCloseCallback()}},{key:"setContent",value:function(t){"string"==typeof t?this.contentContainer.innerHTML=t:(this.contentContainer.innerHTML="",this.contentContainer.appendChild(t))}},{key:"setOnClose",value:function(t){this.onCloseCallback=t}},{key:"setupCloseHandlers",value:function(){var t=this;this.element.addEventListener("click",(function(e){var n=e.target;(n.classList.contains("modal__close")||n.classList.contains("modal")&&t.element.classList.contains("modal_active"))&&t.close()}))}}])&&Pt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=document.querySelector(e);if(!n)throw new Error("Элемент ".concat(e," не найден"));this.element=n}var e,n;return e=t,(n=[{key:"show",value:function(){this.element.classList.add("modal_active")}},{key:"hide",value:function(){this.element.classList.remove("modal_active")}},{key:"setContent",value:function(t){"string"==typeof t?this.element.innerHTML=t:(this.element.innerHTML="",this.element.appendChild(t))}},{key:"getElement",value:function(){return this.element}}])&&jt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qt(r.key),r)}}function qt(t){var e=function(t,e){if("object"!=Ft(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ft(e)?e:e+""}var Lt=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gallery=e,this.cardTemplate=n,this.cdnUrl=r,this.emitter=o}var e,n;return e=t,(n=[{key:"render",value:function(t){var e=this,n={"софт-скил":"soft","хард-скил":"hard",другое:"other",дополнительное:"additional",кнопка:"button"};this.gallery.innerHTML="",t.forEach((function(t){var r=e.cardTemplate.content.firstElementChild.cloneNode(!0),o=r.querySelector(".card__category"),i=r.querySelector(".card__title"),u=r.querySelector(".card__image"),a=r.querySelector(".card__price"),c="card__category_other";t.category&&n[t.category]&&(c="card__category_".concat(n[t.category])),o&&(o.textContent=t.category||"Без категории",o.className="card__category ".concat(c)),i&&(i.textContent=t.title),u&&(u.src=t.image.startsWith("http")?t.image:"".concat(e.cdnUrl,"/").concat(t.image)),a&&(a.textContent=null!==t.price?"".concat(t.price," синапсов"):"Бесценно"),r.addEventListener("click",(function(){e.emitter.emit("product:open",{id:t.id})})),e.gallery.appendChild(r)}))}}])&&It(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bt(r.key),r)}}function Bt(t){var e=function(t,e){if("object"!=At(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==At(e)?e:e+""}var Mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"create",value:function(t,e,n){var r=document.getElementById("card-basket").content.firstElementChild.cloneNode(!0),o=r.querySelector(".basket__item-index"),i=r.querySelector(".card__title"),u=r.querySelector(".card__price"),a=r.querySelector(".basket__item-delete");return o&&(o.textContent=(e+1).toString()),i&&(i.textContent=t.title),u&&(u.textContent="".concat(t.price," синапсов")),a&&a.addEventListener("click",n),r}}],null&&Ut(e.prototype,null),n&&Ut(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vt(r.key),r)}}function Vt(t){var e=function(t,e){if("object"!=Rt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rt(e)?e:e+""}var Yt=function(){function t(e,n,r,o){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e,this.openOrderStep1=n,this.modalView=r,this.basketCounter=this.root.querySelector(".header__basket-counter"),this.basketTemplate=document.getElementById("basket"),this.emitter=o,this.emitter.on("basket:open",(function(){return i.openBasketModal()})),this.emitter.on("cart:changed",(function(){return i.updateCounter()}))}var e,n;return e=t,(n=[{key:"setPresenter",value:function(t){this.presenter=t}},{key:"renderBasketContent",value:function(){var t=this,e=this.basketTemplate.content.cloneNode(!0),n=document.createElement("div");n.appendChild(e);var r=n.querySelector(".basket__list"),o=n.querySelector(".basket__price"),i=n.querySelector(".basket__button");return r.innerHTML="",this.presenter.getItems().forEach((function(e,n){var o=Mt.create(e,n,(function(){t.presenter.handleRemoveItem(e.id),t.openBasketModal(),t.emitter.emit("basket:item:removed",{productId:e.id})}));r.appendChild(o)})),o.textContent="".concat(this.presenter.getTotal()," синапсов"),i&&(i.disabled=0===this.presenter.getCount(),i.onclick=function(){0!==t.presenter.getCount()&&t.openOrderStep1()}),n}},{key:"updateCounter",value:function(){this.basketCounter&&this.presenter&&(this.basketCounter.textContent=this.presenter.getCount().toString())}},{key:"openBasketModal",value:function(){var t=this.renderBasketContent();this.modalView.setContent(t),this.modalView.open(),this.updateCounter()}},{key:"update",value:function(){this.openBasketModal(),this.updateCounter()}},{key:"render",value:function(){this.updateCounter()}}])&&Ht(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$t(r.key),r)}}function $t(t){var e=function(t,e){if("object"!=Dt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dt(e)?e:e+""}var zt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.modal=e}var e,n;return e=t,(n=[{key:"close",value:function(){this.modal.close()}},{key:"getModal",value:function(){return this.modal}}])&&Wt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qt(r.key),r)}}function Qt(t){var e=function(t,e){if("object"!=Jt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Jt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jt(e)?e:e+""}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}function Zt(t){var e=te();return function(){var n,r=ee(t);if(e){var o=ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==Jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function te(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(te=function(){return!!t})()}function ee(t){return ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ee(t)}var ne=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(o,t);var e,n,r=Zt(o);function o(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,t)).presenter=e,i.emitter=n,i}return e=o,n=[{key:"open",value:function(){var t,e=this,n=document.getElementById("order").content.cloneNode(!0),r=document.createElement("div");r.appendChild(n),this.modal.setContent(r),this.modal.open();var o=this.modal.getElement(),i=Array.from(o.querySelectorAll(".order__buttons .button")),u=o.querySelector('input[name="address"]');u.value=this.presenter.getAddress()||"";var a=o.querySelector('.modal__actions .button[type="submit"]'),c=this.presenter.getPayment()||"",f=function(){e.presenter.setPayment(c),e.presenter.setOrderAddress(u.value.trim()),a.disabled=!(c&&u.value.trim());var t=o.querySelector(".form__errors");e.presenter.validateOrder(),t&&(t.textContent=Object.values(e.presenter.getFormErrors()).join(", "))};c&&(i.forEach((function(t){t.getAttribute("name")===c&&t.classList.add("button_alt-active")})),f()),i.forEach((function(t){t.addEventListener("click",(function(){i.forEach((function(t){return t.classList.remove("button_alt-active")})),t.classList.add("button_alt-active"),c=t.getAttribute("name")||"",e.presenter.setPayment(c),f(),e.emitter.emit("order:payment:change",{payment:c})}))})),u.addEventListener("input",(function(){e.presenter.setOrderAddress(u.value.trim()),f(),e.emitter.emit("order:address:change",{address:u.value.trim()})})),null===(t=o.querySelector('form[name="order"]'))||void 0===t||t.addEventListener("submit",(function(t){t.preventDefault();var n=o.querySelector(".form__errors");e.presenter.validateOrder()?(n&&(n.textContent=""),a.disabled||(e.modal.close(),document.body.classList.remove("page_fixed"),e.presenter.onNextStep(c,u.value.trim()),e.emitter.emit("order:submit",{payment:c,address:u.value.trim()}))):n&&(n.textContent=Object.values(e.presenter.getFormErrors()).join(", "))}))}}],n&&Kt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(zt);function re(t){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(t)}function oe(){var t=le(),e=t.m(oe),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,ie(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(oe=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new pe(t,e)},AsyncIterator:fe,async:function(t,e,n,o,u){return(r(e)?ce:ae)(i(t),e,n,o,u)},keys:ue,values:ie}})()}function ie(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(re(t)+" is not iterable")}function ue(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function ae(t,e,n,r,o){var i=ce(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function ce(t,e,n,r,o){return new fe(le().w(t,e,n,r),o||Promise)}function fe(t,e){function n(r,o,i,u){try{var a=t[r](o),c=a.value;return c instanceof pe?e.resolve(c.v).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(c).then((function(t){a.value=t,i(a)}),(function(t){return n("throw",t,i,u)}))}catch(t){u(t)}}var r;this.next||(se(fe.prototype),se(fe.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),se(this,"_invoke",(function(t,o,i){function u(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(u,u):u()}),!0)}function le(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof a?r:a,f=Object.create(c.prototype);return se(f,"_invoke",function(n,r,o){var i,a,c,f=0,l=o||[],s=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function y(n,r){for(a=n,c=r,e=0;!s&&f&&!o&&e<l.length;e++){var o,i=l[e],y=p.p,v=i[2];n>3?(o=v===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=n<2&&y<i[1])?(a=0,p.v=r,p.n=i[1]):y<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,p.n=v,a=0))}if(o||n>1)return u;throw s=!0,r}return function(o,l,v){if(f>1)throw TypeError("Generator is already running");for(s&&1===l&&y(l,v),a=l,c=v;(e=a<2?t:c)||!s;){i||(a?a<3?(a>1&&(p.n=-1),y(a,c)):p.n=c:p.v=c);try{if(f=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(s=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{f=1}}return{value:e,done:s}}}(n,o,i),!0),f}var u={};function a(){}function c(){}function f(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(se(e={},r,(function(){return this})),e),s=f.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,se(t,o,"GeneratorFunction")),t.prototype=Object.create(s),t}return c.prototype=f,se(s,"constructor",f),se(f,"constructor",c),c.displayName="GeneratorFunction",se(f,o,"GeneratorFunction"),se(s),se(s,o,"Generator"),se(s,r,(function(){return this})),se(s,"toString",(function(){return"[object Generator]"})),(le=function(){return{w:i,m:p}})()}function se(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}se=function(t,e,n,r){function i(e,n){se(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},se(t,e,n,r)}function pe(t,e){this.v=t,this.k=e}function ye(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,me(r.key),r)}}function me(t){var e=function(t,e){if("object"!=re(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==re(e)?e:e+""}function de(t,e){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},de(t,e)}function he(t){var e=be();return function(){var n,r=we(t);if(e){var o=we(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==re(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function be(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(be=function(){return!!t})()}function we(t){return we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},we(t)}var ge=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&de(t,e)}(o,t);var e,n,r=he(o);function o(t,e,n,i){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(u=r.call(this,t)).presenter=e,u.onSuccess=n,u.emitter=i,u}return e=o,n=[{key:"open",value:function(t,e){var n,r=this,o=document.getElementById("contacts").content.cloneNode(!0),i=document.createElement("div");i.appendChild(o),this.modal.setContent(i),this.modal.open();var u=this.modal.getElement(),a=u.querySelector('input[name="email"]'),c=u.querySelector('input[name="phone"]'),f=u.querySelector('.modal__actions .button[type="submit"]');a.value=this.presenter.getEmail()||"",c.value=this.presenter.getPhone()||"";var l=function(){f.disabled=!r.presenter.validateContactFields()};l(),a.addEventListener("input",(function(){r.presenter.setEmail(a.value),r.presenter.validateContactFields();var t=u.querySelector(".form__errors");t&&(t.textContent=Object.values(r.presenter.getFormErrors()).join(", ")),l(),r.emitter.emit("contacts:email:change",{email:a.value})})),c.addEventListener("input",(function(){r.presenter.setPhone(c.value),r.presenter.validateContactFields();var t=u.querySelector(".form__errors");t&&(t.textContent=Object.values(r.presenter.getFormErrors()).join(", ")),l(),r.emitter.emit("contacts:phone:change",{phone:c.value})})),null===(n=u.querySelector('form[name="contacts"]'))||void 0===n||n.addEventListener("submit",function(){var n,o=(n=oe().mark((function n(o){var i,a,c,f;return oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.preventDefault(),c=u.querySelector(".form__errors"),r.presenter.validateContactFields()){n.next=7;break}return c&&(c.textContent=Object.values(r.presenter.getFormErrors()).join(", ")),n.abrupt("return");case 7:c&&(c.textContent="");case 8:return n.prev=8,n.next=11,r.presenter.submitOrder(t,e);case 11:(f=n.sent).success?(r.onSuccess(null!==(i=f.total)&&void 0!==i?i:0),r.emitter.emit("contacts:submit",{payment:t,address:e,total:null!==(a=f.total)&&void 0!==a?a:0})):c&&(c.textContent=f.error||"Ошибка при оформлении заказа"),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(8),c&&(c.textContent="Ошибка при оформлении заказа");case 18:case"end":return n.stop()}}),n,null,[[8,15]])})),function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function u(t){ye(i,r,o,u,a,"next",t)}function a(t){ye(i,r,o,u,a,"throw",t)}u(void 0)}))});return function(t){return o.apply(this,arguments)}}())}}],n&&ve(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(zt);function Se(t){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Se(t)}function Oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,je(r.key),r)}}function je(t){var e=function(t,e){if("object"!=Se(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Se(e)?e:e+""}var ke=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.modalView=e,this.onClose=n,this.emitter=r}var e,n;return e=t,(n=[{key:"open",value:function(t){var e=this,n=document.getElementById("success").content.cloneNode(!0),r=this.modalView.getElement().querySelector(".modal__content");if(r){r.innerHTML="",r.appendChild(n);var o=r.querySelector(".order-success__description");o&&(o.textContent="Списано ".concat(t," синапсов"))}this.modalView.open(),this.modalView.setOnClose((function(){e.onClose(),e.emitter.emit("modal:success:close",{total:t})}));var i=this.modalView.getElement().querySelector(".order-success__close");i&&i.addEventListener("click",(function(){e.modalView.close(),e.emitter.emit("modal:success:close",{total:t})}))}}])&&Oe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xe(r.key),r)}}function xe(t){var e=function(t,e){if("object"!=_e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=_e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_e(e)?e:e+""}var Ee=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.template=e,this.cdnUrl=n,this.emitter=r}var e,n;return e=t,(n=[{key:"render",value:function(t,e){var n=this,r=this.template.content.cloneNode(!0),o=document.createElement("div");o.appendChild(r);var i=o.querySelector(".card__image"),u=o.querySelector(".card__category"),a=o.querySelector(".card__title"),c=o.querySelector(".card__text"),f=o.querySelector(".card__price"),l=o.querySelector(".card__button");return i&&(i.src=t.image.startsWith("http")?t.image:"".concat(this.cdnUrl,"/").concat(t.image)),u&&(u.textContent=t.category||""),a&&(a.textContent=t.title),c&&(c.textContent=t.description||""),f&&(f.textContent=null!==t.price?"".concat(t.price," синапсов"):"Бесценно"),l&&(null===t.price?(l.disabled=!0,l.textContent="Недоступно"):e?(l.disabled=!1,l.textContent="Удалить из корзины",l.onclick=function(){n.emitter.emit("cart:remove",{productId:t.id}),n.emitter.emit("modal:close")}):(l.disabled=!1,l.textContent="В корзину",l.onclick=function(){n.emitter.emit("cart:add",{product:t}),n.emitter.emit("modal:close")})),o}}])&&Pe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function Te(){var t=Le(),e=t.m(Te),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,o[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(r.d,Ne(t),i)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(Te=function(){return{wrap:function(e,n,r,o){return t.w(i(e),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new Ue(t,e)},AsyncIterator:qe,async:function(t,e,n,o,u){return(r(e)?Ie:Fe)(i(t),e,n,o,u)},keys:Ge,values:Ne}})()}function Ne(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Ce(t)+" is not iterable")}function Ge(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Fe(t,e,n,r,o){var i=Ie(t,e,n,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Ie(t,e,n,r,o){return new qe(Le().w(t,e,n,r),o||Promise)}function qe(t,e){function n(r,o,i,u){try{var a=t[r](o),c=a.value;return c instanceof Ue?e.resolve(c.v).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(c).then((function(t){a.value=t,i(a)}),(function(t){return n("throw",t,i,u)}))}catch(t){u(t)}}var r;this.next||(Ae(qe.prototype),Ae(qe.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ae(this,"_invoke",(function(t,o,i){function u(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(u,u):u()}),!0)}function Le(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof a?r:a,f=Object.create(c.prototype);return Ae(f,"_invoke",function(n,r,o){var i,a,c,f=0,l=o||[],s=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function y(n,r){for(a=n,c=r,e=0;!s&&f&&!o&&e<l.length;e++){var o,i=l[e],y=p.p,v=i[2];n>3?(o=v===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=n<2&&y<i[1])?(a=0,p.v=r,p.n=i[1]):y<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,p.n=v,a=0))}if(o||n>1)return u;throw s=!0,r}return function(o,l,v){if(f>1)throw TypeError("Generator is already running");for(s&&1===l&&y(l,v),a=l,c=v;(e=a<2?t:c)||!s;){i||(a?a<3?(a>1&&(p.n=-1),y(a,c)):p.n=c:p.v=c);try{if(f=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(s=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{f=1}}return{value:e,done:s}}}(n,o,i),!0),f}var u={};function a(){}function c(){}function f(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ae(e={},r,(function(){return this})),e),s=f.prototype=a.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,Ae(t,o,"GeneratorFunction")),t.prototype=Object.create(s),t}return c.prototype=f,Ae(s,"constructor",f),Ae(f,"constructor",c),c.displayName="GeneratorFunction",Ae(f,o,"GeneratorFunction"),Ae(s),Ae(s,o,"Generator"),Ae(s,r,(function(){return this})),Ae(s,"toString",(function(){return"[object Generator]"})),(Le=function(){return{w:i,m:p}})()}function Ae(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ae=function(t,e,n,r){function i(e,n){Ae(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},Ae(t,e,n,r)}function Ue(t,e){this.v=t,this.k=e}function Be(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}var Me=new F(new b(o,"https://larek-api.nomoreparties.co/api/weblarek")),Re=new A,He=new W,Ve=new H,Ye=document.querySelector(".gallery"),De=document.getElementById("card-catalog"),We=document.getElementById("card-preview"),$e=document.querySelector(".header__basket"),ze=document.querySelector(".header__container"),Je=new Gt("#modal-container",r),Ke=new Ee(We,o,r),Qe=new Lt(Ye,De,o,r),Xe=new Yt(ze,(function(){return rn.open()}),Je,r),Ze=new ke(Je,(function(){return Xe.updateCounter()}),r),tn=function(t,e,n){return{getEmail:function(){return t.email},getPhone:function(){return t.phone},getFormErrors:function(){return t.formErrors},setEmail:function(e){return t.setEmail(e)},setPhone:function(e){return t.setPhone(e)},validateContactFields:function(){return t.validateContactFields()},submitOrder:function(r,o){return(i=z().mark((function i(){var u,a;return z().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u={payment:r,address:o,email:t.email,phone:t.phone,total:e.getTotal(),items:e.getItems().map((function(t){return t.id}))},i.prev=1,i.next=4,n.sendOrder(u);case 4:if(!(a=i.sent).id){i.next=11;break}return e.clear(),t.clear(),i.abrupt("return",{success:!0,total:a.total});case 11:return i.abrupt("return",{success:!1,error:a.error||"Ошибка при оформлении заказа"});case 12:i.next=17;break;case 14:return i.prev=14,i.t0=i.catch(1),i.abrupt("return",{success:!1,error:"Ошибка при оформлении заказа"});case 17:case"end":return i.stop()}}),i,null,[[1,14]])})),function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function u(t){rt(o,n,r,u,a,"next",t)}function a(t){rt(o,n,r,u,a,"throw",t)}u(void 0)}))})();var i}}}(He,Ve,Me),en=new ge(Je,tn,(function(t){Ve.clear(),He.clear(),Ze.open(t)}),r),nn=function(t,e){return{getAddress:function(){return t.address},getPayment:function(){return t.payment},getFormErrors:function(){return t.formErrors},setPayment:function(e){return t.setPayment(e)},setOrderAddress:function(e){return t.setOrderAddress(e)},validateOrder:function(){return t.validateOrder()},onNextStep:function(t,e){return function(t,e){return en.open(t,e)}(t,e)}}}(He),rn=new ne(Je,nn,r),on=new St(Ve);Xe.setPresenter(on);var un=new ht(Re,Qe,Me);r.on("product:open",(function(t){var e=Re.getProduct(t.id);if(e){var n=Ve.hasProduct(e.id),r=Ke.render(e,n);Je.setContent(r),Je.open()}})),r.on("cart:add",(function(t){Ve.addItem(t.product),Xe.openBasketModal()})),r.on("cart:remove",(function(t){Ve.removeItem(t.productId),Xe.openBasketModal()}));var an=r.trigger("basket:open");function cn(){var t;return t=Te().mark((function t(){var e;return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Me.getProducts();case 2:e=t.sent,Re.setProducts(e),un.fetchAndRender(),Xe.updateCounter();case 6:case"end":return t.stop()}}),t)})),cn=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){Be(i,r,o,u,a,"next",t)}function a(t){Be(i,r,o,u,a,"throw",t)}u(void 0)}))},cn.apply(this,arguments)}null==$e||$e.addEventListener("click",an),r.on("basket:open",(function(){Xe.openBasketModal()})),function(){cn.apply(this,arguments)}()})();